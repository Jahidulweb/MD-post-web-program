<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Style Viewer</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.2.0/github-markdown.min.css">
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js"></script>

    <style>
        body {
            background-color: #ffffff;
            margin: 0;
            padding: 0;
        }
        
        /* গিটহাবের মতো কন্টেইনার */
        .markdown-body {
            box-sizing: border-box;
            min-width: 200px;
            max-width: 980px;
            margin: 40px auto;
            padding: 45px;
            border: 1px solid #d0d7de;
            border-radius: 6px;
        }

        @media (max-width: 767px) {
            .markdown-body { padding: 15px; border: none; }
        }

        /* কপি বাটন স্টাইল - একদম গিটহাবের মতো */
        .code-wrapper { position: relative; }
        .copy-btn {
            position: absolute;
            right: 8px;
            top: 8px;
            padding: 4px 8px;
            background-color: #f6f8fa;
            border: 1px solid #d0d7de;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            color: #24292f;
            display: none; /* মাউস নিলে দেখা যাবে */
            transition: 0.2s;
        }
        .code-wrapper:hover .copy-btn { display: block; }
        .copy-btn:hover { background-color: #ebeff2; border-color: #1b1f2426; }
    </style>
</head>
<body>

    <article id="content" class="markdown-body">
        লোডিং...
    </article>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const fileName = urlParams.get('file');

        // Marked.js কনফিগারেশন (GitHub এর মতো ব্রেকলিন সাপোর্ট)
        marked.setOptions({
            gfm: true,
            breaks: true
        });

        if (fileName) {
            fetch(`posts/${fileName}`)
                .then(res => {
                    if(!res.ok) throw new Error("ফাইল পাওয়া যায়নি");
                    return res.text();
                })
                .then(markdown => {
                    document.getElementById('content').innerHTML = marked.parse(markdown);
                    setupCodeBlocks();
                    Prism.highlightAll();
                })
                .catch(err => {
                    document.getElementById('content').innerHTML = `<h1>Error 404</h1><p>${err.message}</p>`;
                });
        }

        function setupCodeBlocks() {
            document.querySelectorAll('pre').forEach((pre) => {
                // র্যাপিং কন্টেইনার
                const wrapper = document.createElement('div');
                wrapper.className = 'code-wrapper';
                pre.parentNode.insertBefore(wrapper, pre);
                wrapper.appendChild(pre);

                // কপি বাটন
                const btn = document.createElement('button');
                btn.className = 'copy-btn';
                btn.innerHTML = 'Copy';

                btn.addEventListener('click', () => {
                    const code = pre.querySelector('code').innerText;
                    navigator.clipboard.writeText(code).then(() => {
                        btn.innerHTML = '✅ Copied!';
                        setTimeout(() => btn.innerHTML = 'Copy', 2000);
                    });
                });

                wrapper.appendChild(btn);
            });
        }
    </script>
</body>
</html>
